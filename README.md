### ä¹‹å‰webpackçš„ä¸€äº›è®¤è¯†

ä¹‹å‰æ¥è§¦åˆ°webpackçš„åœ°æ–¹åªæœ‰vue-cliå·¥å…·äº†ï¼ˆç”¨äºç”Ÿæˆvueå•é¡µé¢é¡¹ç›®å·¥ç¨‹ï¼‰`vue init webpack project-name`ã€‚

å› ä¸ºç”Ÿæˆçš„é¡¹ç›®å…³äºwebpackçš„é…ç½®å¼‚å¸¸åºå¤§ï¼ˆå¯¹äºæˆ‘æ¥è¯´æ˜¯çš„ï¼‰ã€‚æ‰€ä»¥ä¹Ÿæ²¡æƒ³åˆ°å»æ·±å…¥äº†è§£å¦‚ä½•ä½¿ç”¨webpackã€‚

å¦å¤–è¿˜äº†è§£webpackå¯èƒ½æ˜¯ä¸€ä¸ªæ‰“åŒ…å·¥å…·ï¼Œå…·ä½“å¦‚ä½•æ‰“åŒ…æ€ä¹ˆæ ·æ‰“åŒ…éƒ½ä¸æ¸…æ¥šã€‚

åœ¨æœ€è¿‘çš„ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œå­¦ä¹ äº†å¦‚ä½•å¼€å‘ä¸€ä¸ªvueæ’ä»¶ï¼Œä½¿ç”¨çš„å‘½ä»¤æ˜¯`vue init webpack-simple project`ã€‚è¯¥å‘½ä»¤ç”Ÿæˆçš„é¡¹ç›®å·¥ç¨‹ç»“æ„å°±æ¯”è¾ƒç®€å•ã€‚webpackçš„é…ç½®ä¹Ÿä¸€ç›®äº†ç„¶ï¼ˆè§†è§‰ä¸Šï¼Œå¹¶ä¸æ˜¯ç†è§£ä¸Šï¼ŒğŸ¤£ï¼‰ã€‚

#### é‚£ä»€ä¹ˆæ˜¯webpack

webpackå¯ä»¥çœ‹åšæ˜¯æ¨¡å—æ‰“åŒ…æœºï¼šå®ƒåšçš„äº‹æƒ…æ˜¯ï¼Œåˆ†æä½ çš„é¡¹ç›®ç»“æ„ï¼Œæ‰¾åˆ°JavaScriptæ¨¡å—ä»¥åŠå…¶å®ƒçš„ä¸€äº›æµè§ˆå™¨ä¸èƒ½ç›´æ¥è¿è¡Œçš„æ‹“å±•è¯­è¨€ï¼ˆScssï¼ŒTypeScriptç­‰ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢å’Œæ‰“åŒ…ä¸ºåˆé€‚çš„æ ¼å¼ä¾›æµè§ˆå™¨ä½¿ç”¨ã€‚

### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨webpack

ç°ä»Šçš„å¾ˆå¤šç½‘é¡µå…¶å®å¯ä»¥çœ‹åšæ˜¯åŠŸèƒ½ä¸°å¯Œçš„åº”ç”¨ï¼Œå®ƒä»¬æ‹¥æœ‰ç€å¤æ‚çš„JavaScriptä»£ç å’Œä¸€å¤§å †ä¾èµ–åŒ…ã€‚ä¸ºäº†ç®€åŒ–å¼€å‘çš„å¤æ‚åº¦ï¼Œå‰ç«¯ç¤¾åŒºæ¶Œç°å‡ºäº†å¾ˆå¤šå¥½çš„å®è·µæ–¹æ³•

- æ¨¡å—åŒ–ï¼Œè®©æˆ‘ä»¬å¯ä»¥æŠŠå¤æ‚çš„ç¨‹åºç»†åŒ–ä¸ºå°çš„æ–‡ä»¶;
- ç±»ä¼¼äºTypeScriptè¿™ç§åœ¨JavaScriptåŸºç¡€ä¸Šæ‹“å±•çš„å¼€å‘è¯­è¨€ï¼šä½¿æˆ‘ä»¬èƒ½å¤Ÿå®ç°ç›®å‰ç‰ˆæœ¬çš„JavaScriptä¸èƒ½ç›´æ¥ä½¿ç”¨çš„ç‰¹æ€§ï¼Œå¹¶ä¸”ä¹‹åè¿˜èƒ½è½¬æ¢ä¸ºJavaScriptæ–‡ä»¶ä½¿æµè§ˆå™¨å¯ä»¥è¯†åˆ«ï¼›
- Scssï¼Œlessç­‰CSSé¢„å¤„ç†å™¨
- ...

### ç›¸å…³æ•™ç¨‹

[webpackå®˜æ–¹æ–‡æ¡£](https://www.webpackjs.com/)

æˆ‘æ˜¯çœ‹ä¸‹é¢è¿™ç¯‡åšå®¢å¼€å§‹äº†è§£webpackçš„ä¸€äº›æ¦‚å¿µå’Œæ¨¡å—åŠŸèƒ½ã€‚æ•™ç¨‹æ˜¯åŸºäºwebpack1.xçš„ï¼Œç°åœ¨æœ€æ–°çš„webpackå·²ç»æ˜¯4.xã€‚ä½œè€…å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™å·²ç»æ˜¯v4.8.3äº†ã€‚

[å…¥é—¨webpack çœ‹è¿™ç¯‡å°±å¤Ÿ](https://segmentfault.com/a/1190000006178770)

å› ä¸ºä¸€äº›æ“ä½œå¯èƒ½ä¼šæœ‰åå·®ï¼Œæ‰€ä»¥æˆ‘åˆæ‰¾äº†ä¸€ç¯‡åŸºäºwebpack4.0çš„æ•™ç¨‹æ–‡ç« 

[webpack 4 æ•™ç¨‹](https://blog.zfanw.com/webpack-tutorial/#%E5%AE%89%E8%A3%85-webpack)

### çˆ¬å‘è¿‡ç¨‹

#### æ–°å»ºä¸€ä¸ªwebpack-demoæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶

```bash
# è¯¥å‘½ä»¤ä¼šä¸€æ­¥ä¸€æ­¥æç¤ºä½ ï¼Œä½ è¯¥è¾“å…¥ä»€ä¹ˆ
npm init
```

```bash
# ä¸€é”®ç”Ÿæˆpackage.jsonæ–‡ä»¶
npm init -y
```

#### æ–°å»ºä¸€ä¸ªinedx.htmlå¹¶å†™å…¥æœ€åŸºæœ¬çš„htmlä»£ç ã€‚å®ƒåœ¨è¿™é‡Œçš„ä½œç”¨æ˜¯å¼•å…¥æ‰“åŒ…åçš„jsæ–‡ä»¶ï¼ˆè¿™é‡Œæˆ‘ä»¬å…ˆå‘½åä¸ºbundle.jsï¼‰

```html
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>webpack æ•™ç¨‹</title>
</head>
<body>
  
<script type="text/javascript" src="bundle.js"></script>
</body>
</html>
```

#### æ–°å»ºä¸€ä¸ªgreeter.jsï¼Œä¾æ®CommonJSè§„èŒƒå¯¼å‡ºè¿™ä¸ªå‡½æ•°ä¸ºä¸€ä¸ªæ¨¡å—

```JavaScript
module.exports = function() {
  var greet = document.createElement('div');
  greet.textContent = "Hello World";
  return greet;
};
```

#### æ–°å»ºä¸€ä¸ªmain.jså…¥å£å‡½æ•°ï¼ŒæŠŠgreeter.jsæ¨¡å—è¿”å›çš„èŠ‚ç‚¹æ’å…¥åˆ°é¡µé¢

```JavaScript
const greeter = require('./Greeter.js');
document.querySelector("#root").appendChild(greeter());
```

#### æ­£å¼ä½¿ç”¨webpack

##### åœ¨æ­¤ä¹‹å‰å…ˆå®‰è£…webpack
```bash
# å±€éƒ¨å®‰è£…
npm install --save-dev webpack
```

```bash
# {extry file}å‡ºå¡«å†™å…¥å£æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ¬æ–‡ä¸­å°±æ˜¯ä¸Šè¿°main.jsçš„è·¯å¾„ï¼Œ
# {destination for bundled file}å¤„å¡«å†™æ‰“åŒ…æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„
# å¡«å†™è·¯å¾„çš„æ—¶å€™ä¸ç”¨æ·»åŠ {}
webpack {entry file} {destination for bundled file}
```

##### æŒ‡å®šå…¥å£æ–‡ä»¶åï¼Œwebpackå°†è‡ªåŠ¨è¯†åˆ«é¡¹ç›®æ‰€ä¾èµ–çš„å…¶å®ƒæ–‡ä»¶ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœä½ çš„webpackä¸æ˜¯å…¨å±€å®‰è£…çš„ï¼Œé‚£ä¹ˆå½“ä½ åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨æ­¤å‘½ä»¤æ—¶ï¼Œéœ€è¦é¢å¤–æŒ‡å®šå…¶åœ¨node_modulesä¸­çš„åœ°å€ï¼Œç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥å¦‚ä¸‹å‘½ä»¤

[çŸ¥ä¹ä¸“æ  npxæ˜¯ä»€ä¹ˆ](https://zhuanlan.zhihu.com/p/27840803)

```bash
# webpackéå…¨å±€å®‰è£…çš„æƒ…å†µ
node_modules/.bin/webpack main.js bundle.js
```

å½“è¿è¡Œä¹‹åç²—çº¿æç¤º

```bash
The CLI moved into a separate package: webpack-cli
Would you like to install webpack-cli? (That will run npm install -D webpack-cli) (yes/NO)
```
é€‰æ‹©yeså¹¶ç»§ç»­

å‡ºé”™ï¼ˆç›®å‰ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œä»¥åå†è¯´ï¼‰ï¼Œåˆ é™¤node_modulesæ–‡ä»¶å¤¹åå†é‡æ–°cnpm install

ç„¶å
```bash
cnpm install webpack-cli --save--dev
```

ç„¶åç»§ç»­æ‰§è¡Œ
```bash
# webpackéå…¨å±€å®‰è£…çš„æƒ…å†µ
node_modules/.bin/webpack main.js bundle.js
```

æŠ¥é”™
```bash
ERROR in multi ./main.js bundle.js
Module not found: Error: Can't resolve 'bundle.js' in '/Users/yuansichao/Desktop/webpack-demo'
 @ multi ./main.js bundle.js
```

ä¹Ÿä¸çŸ¥é“ä»€ä¹ˆæ„æ€ï¼ˆä¸Šè¿°å‘½ä»¤å‚ç…§webpack1.xçš„æ•™ç¨‹ï¼Œè§‰å¾—å¯èƒ½æœ‰è¯¯ï¼Œæ‰€ä»¥ååˆå‚ç…§webpack4.xçš„æ•™ç¨‹ï¼Œæ·»åŠ äº† -oï¼Œæ‰“åŒ…æˆåŠŸï¼‰

ç„¶åç»§ç»­æ‰§è¡Œ
```bash
# webpackéå…¨å±€å®‰è£…çš„æƒ…å†µ
node_modules/.bin/webpack main.js -o bundle.js
```

```bash
Hash: 8ca054b91b7193e4a64e
Version: webpack 4.8.3
Time: 304ms
Built at: 2018-05-17 14:30:20
    Asset       Size  Chunks             Chunk Names
bundle.js  718 bytes       0  [emitted]  main
Entrypoint main = bundle.js
[0] ./Greeter.js 130 bytes {0} [built]
[1] ./main.js 96 bytes {0} [built]

WARNING in configuration
The 'mode' option has not been set, webpack will fallback to 'production' for this value. Set 'mode' option to 'development' or 'production' to enable defaults for each environment.
You can also set it to 'none' to disable any default behavior. Learn more: https://webpack.js.org/concepts/mode/
```
æ‰“åŒ…æˆåŠŸï¼Œä½†å‡ºç°é»„è‰²è­¦å‘Šã€‚è¿™æ˜¯ webpack 4 å¼•å…¥çš„æ¨¡å¼ï¼ŒåŒ…æ‹¬ developmentã€productionã€none ä¸‰ä¸ªå€¼ï¼Œæˆ‘ä»¬ä¸ä¼ å…¥å€¼çš„è¯ï¼Œé»˜è®¤ä½¿ç”¨ productionã€‚

è°ƒæ•´ä¸‹å‘½ä»¤

```bash
# webpackéå…¨å±€å®‰è£…çš„æƒ…å†µ
node_modules/.bin/webpack main.js -o bundle.js --mode development
```

ä¸å‡ºç°é»„è‰²è­¦å‘Šäº†

æ‰“å¼€index.htmlï¼Œå¯ä»¥å‘ç°è¿è¡ŒæˆåŠŸ

![](https://ws2.sinaimg.cn/large/006tNc79ly1frebu0f0yrj30b505ot8h.jpg)

PS:å¦‚æœä¸æŒ‡å®šè¾“å…¥è¾“å‡ºä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿæˆ‘ä»¬æ¥è¯•ä¸€ä¸‹

```bash
yuansichaodeMacBook-Pro:webpack-demo yuansichao$ node_modules/.bin/webpack --mode development
Hash: 5737d556ca16cd40cb8f
Version: webpack 4.8.3
Time: 52ms
Built at: 2018-05-17 14:39:07

ERROR in Entry module not found: Error: Can't resolve './src' in '/Users/yuansichao/Desktop/webpack-demo'
```

æŠ¥é”™ï¼Œè¯´åœ¨ ./src ä¸‹æ‰¾ä¸åˆ° main.js æ–‡ä»¶ - è¿™ä¹Ÿæ˜¯ webpack 4 å¼•å…¥çš„çº¦å®šï¼Œä¸æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„è¯ï¼Œåˆ™é»˜è®¤ä¸º src/main.jsã€‚æˆ‘ä»¬æŒ‰ç…§çº¦å®šå°†é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ main.js ç§»åŠ¨åˆ° src/main.jsï¼š

```bash
mkdir src
mv main.js src
```

é‡æ–°è¿è¡Œä¸€ä¸‹

```bash
yuansichaodeMacBook-Pro:webpack-demo yuansichao$ node_modules/.bin/webpack --mode development
Hash: 5737d556ca16cd40cb8f
Version: webpack 4.8.3
Time: 62ms
Built at: 2018-05-17 14:41:08

ERROR in Entry module not found: Error: Can't resolve './src' in '/Users/yuansichao/Desktop/webpack-demo'
```
è¿˜æ˜¯æ‰¾ä¸åˆ°æ–‡ä»¶ã€‚åŸæ¥webpack 4 å¼•å…¥çš„çº¦å®šï¼Œä¸æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„è¯ï¼Œåˆ™é»˜è®¤ä¸º src/index.jsï¼Œæ‰€ä»¥å…¥å£æ–‡ä»¶main.jsä¿®æ”¹ä¸ºindex.jsï¼Œå¹¶ä¿®æ”¹index.jså†…ä¾èµ–æ–‡ä»¶çš„è·¯å¾„

é‡æ–°è¿è¡Œ

```bash
yuansichaodeMacBook-Pro:webpack-demo yuansichao$ node_modules/.bin/webpack --mode development
Hash: 655e62712617ff21843f
Version: webpack 4.8.3
Time: 115ms
Built at: 2018-05-17 14:42:36
  Asset      Size  Chunks             Chunk Names
main.js  3.32 KiB    main  [emitted]  main
Entrypoint main = main.js
[./Greeter.js] 130 bytes {main} [built]
[./src/index.js] 97 bytes {main} [built]
```

é»˜è®¤åœ¨/distæ–‡ä»¶å¤¹ç”Ÿæˆäº†main.jsï¼Œä¸ºä»€ä¹ˆæ˜¯main.jsï¼Ÿè¿™ä¹Ÿæ­£æ˜¯ webpack 4 æœªæŒ‡å®šè¾“å‡ºæ–‡ä»¶æ—¶é»˜è®¤çš„ä½ç½®å§

#### é€šè¿‡é…ç½®æ–‡ä»¶æ¥ä½¿ç”¨webpack

webpackæ‹¥æœ‰å¾ˆå¤šå…¶å®ƒçš„æ¯”è¾ƒé«˜çº§çš„åŠŸèƒ½ï¼ˆæ¯”å¦‚è¯´æœ¬æ–‡åé¢ä¼šä»‹ç»çš„loaderså’Œpluginsï¼‰ï¼Œè¿™äº›åŠŸèƒ½å…¶å®éƒ½å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¨¡å¼å®ç°ï¼Œä½†æ˜¯æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œè¿™æ ·ä¸å¤ªæ–¹ä¾¿ä¸”å®¹æ˜“å‡ºé”™çš„ï¼Œæ›´å¥½çš„åŠæ³•æ˜¯å®šä¹‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªç®€å•çš„JavaScriptæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰çš„ä¸æ‰“åŒ…ç›¸å…³çš„ä¿¡æ¯æ”¾åœ¨é‡Œé¢ã€‚

##### åœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªwebpack.config.jsçš„æ–‡ä»¶

```JavaScript
module.exports = {
  entry:  __dirname + "/src/index.js",  //å·²å¤šæ¬¡æåŠçš„å”¯ä¸€å…¥å£æ–‡ä»¶
  output: {
    path: __dirname + "/dist",          //æ‰“åŒ…åçš„æ–‡ä»¶å­˜æ”¾çš„åœ°æ–¹
    filename: "bundle.js"               //æ‰“åŒ…åè¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å
  }
}
```
> **æ³¨ï¼š** **__dirname**æ˜¯Node.jsä¸­çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒä»£è¡¨å½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•

æœ‰äº†è¿™ä¸ªé…ç½®ï¼Œåœ¨å‘½ä»¤è¡Œæ‰§è¡Œ

```bash
# å…¨å±€å®‰è£…webpack
webpack
# éå…¨å±€å®‰è£…webpack
node_modules/.bin/webpack
```
æœ‰è­¦å‘Šå¹¶å‡ºé”™

```bash
Hash: 40caf2ed6b9f42cad00c
Version: webpack 4.8.3
Time: 70ms
Built at: 2018-05-17 15:01:17

WARNING in configuration
The 'mode' option has not been set, webpack will fallback to 'production' for this value. Set 'mode' option to 'development' or 'production' to enable defaults for each environment.
You can also set it to 'none' to disable any default behavior. Learn more: https://webpack.js.org/concepts/mode/

ERROR in Entry module not found: Error: Can't resolve '/Users/yuansichao/Desktop/webpack-demo/src/main.js' in '/Users/yuansichao/Desktop/webpack-demo'
```
è­¦å‘Šæ˜¯å› ä¸ºæ²¡æœ‰æŒ‡å®šæ¨¡å¼

å‡ºé”™æ˜¯å› ä¸ºæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶

åˆšåˆšæˆ‘æ²¡æœ‰ä¿å­˜webpack.config.jsæ–‡ä»¶ğŸ˜“ã€‚ã€‚ã€‚ä¿å­˜å®Œä¹‹åæ‰“åŒ…æˆåŠŸ


##### ä¸Šé¢å·²ç»è¯´äº†ä¸¤ç§webpackçš„æ‰“åŒ…æ–¹æ³•ï¼Œæ¥ä¸‹æ¥ä»‹ç»ä¸€ç§æ›´åŠ å¿«æ·æ–¹ä¾¿çš„æ‰“åŒ…æ–¹æ³•

åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‘½ä»¤éœ€è¦ä»£ç ç±»ä¼¼äºnode_modules/.bin/webpackè¿™æ ·çš„è·¯å¾„å…¶å®æ˜¯æ¯”è¾ƒçƒ¦äººçš„ï¼Œä¸è¿‡å€¼å¾—åº†å¹¸çš„æ˜¯**npmå¯ä»¥å¼•å¯¼ä»»åŠ¡æ‰§è¡Œ**ï¼Œå¯¹npmè¿›è¡Œé…ç½®åå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ç®€å•çš„npm startå‘½ä»¤æ¥æ›¿ä»£ä¸Šé¢ç•¥å¾®ç¹ççš„å‘½ä»¤ã€‚åœ¨package.jsonä¸­å¯¹scriptså¯¹è±¡è¿›è¡Œç›¸å…³è®¾ç½®å³å¯ï¼Œè®¾ç½®æ–¹æ³•å¦‚ä¸‹ã€‚ä¿®æ”¹package.jsonæ–‡ä»¶

```json
{
  "name": "webpack-demo",
  "version": "1.0.0",
  "description": "webpack æ•™ç¨‹",
  "main": "bundle.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "start": "node_modules/.bin/webpack"
    //"start":"webpack" //ä¸ç®¡webpackæ˜¯å±€éƒ¨è¿˜æ˜¯å…¨å±€å®‰è£…çš„
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "webpack": "^4.8.3"
  }
}
```
> **æ³¨ï¼š** package.jsonä¸­çš„scriptä¼šå®‰è£…ä¸€å®šé¡ºåºå¯»æ‰¾å‘½ä»¤å¯¹åº”ä½ç½®ï¼Œæœ¬åœ°çš„node_modules/.binè·¯å¾„å°±åœ¨è¿™ä¸ªå¯»æ‰¾æ¸…å•ä¸­ï¼Œæ‰€ä»¥æ— è®ºæ˜¯å…¨å±€è¿˜æ˜¯å±€éƒ¨å®‰è£…çš„Webpackï¼Œä½ éƒ½ä¸éœ€è¦å†™å‰é¢é‚£æŒ‡æ˜è¯¦ç»†çš„è·¯å¾„äº†ã€‚

npmçš„startå‘½ä»¤æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è„šæœ¬åç§°ï¼Œå…¶ç‰¹æ®Šæ€§è¡¨ç°åœ¨ï¼Œåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨npm startå°±å¯ä»¥æ‰§è¡Œå…¶å¯¹äºçš„å‘½ä»¤ï¼Œå¦‚æœå¯¹åº”çš„æ­¤è„šæœ¬åç§°ä¸æ˜¯startï¼Œæƒ³è¦åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œæ—¶ï¼Œéœ€è¦è¿™æ ·ç”¨npm run {script name}å¦‚npm run buildï¼Œæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥npm startè¯•è¯•ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š

```bash
> webpack-demo@1.0.0 start /Users/yuansichao/Desktop/webpack-demo
> webpack

Hash: b18dec58d2a25b156fc7
Version: webpack 4.8.3
Time: 110ms
Built at: 2018-05-17 15:12:29
    Asset       Size  Chunks             Chunk Names
bundle.js  718 bytes       0  [emitted]  main
Entrypoint main = bundle.js
[0] ./Greeter.js 130 bytes {0} [built]
[1] ./src/index.js 97 bytes {0} [built]

WARNING in configuration
The 'mode' option has not been set, webpack will fallback to 'production' for this value. Set 'mode' option to 'development' or 'production' to enable defaults for each environment.
You can also set it to 'none' to disable any default behavior. Learn more: https://webpack.js.org/concepts/mode/
```
æ‰“åŒ…æˆåŠŸï¼Œæœ‰è­¦å‘Šæ˜¯å› ä¸ºæ²¡æœ‰æŒ‡å®šæ¨¡å¼ã€‚

#### ä½¿ç”¨webpackæ„å»ºæœ¬åœ°æœåŠ¡å™¨

æƒ³ä¸æƒ³è®©ä½ çš„æµè§ˆå™¨ç›‘å¬ä½ çš„ä»£ç çš„ä¿®æ”¹ï¼Œå¹¶è‡ªåŠ¨åˆ·æ–°æ˜¾ç¤ºä¿®æ”¹åçš„ç»“æœï¼Œå…¶å®Webpackæä¾›ä¸€ä¸ªå¯é€‰çš„æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼Œè¿™ä¸ªæœ¬åœ°æœåŠ¡å™¨åŸºäºnode.jsæ„å»ºï¼Œå¯ä»¥å®ç°ä½ æƒ³è¦çš„è¿™äº›åŠŸèƒ½ï¼Œä¸è¿‡å®ƒæ˜¯ä¸€ä¸ªå•ç‹¬çš„ç»„ä»¶ï¼Œåœ¨webpackä¸­è¿›è¡Œé…ç½®ä¹‹å‰éœ€è¦å•ç‹¬å®‰è£…å®ƒä½œä¸ºé¡¹ç›®ä¾èµ–

```bash
npm install --save-dev webpack-dev-server
```
è¯•äº†äº†ä¸€ä¸‹ä¸Šé¢çš„å‘½ä»¤ï¼Œä¸‹è½½é¾Ÿé€Ÿ...è¿˜æ˜¯é€‰æ‹©cnpm

ä¸‹è½½å®Œä¹‹åï¼Œå¯åœ¨webpack.config.jsé…ç½®devServerï¼ˆé€šè¿‡é…ç½®æ–‡ä»¶é…ç½®æ›´åŠ å¿«æ·å§ï¼‰,ä¹Ÿå¯ä½¿ç”¨å‘½ä»¤è¡Œ

[è‹±æ–‡æ–‡æ¡£ webpack DevServer](https://webpack.js.org/configuration/dev-server/)

é‡Œé¢è®²äº†å¾ˆå¤šé…ç½®é¡¹ï¼Œä¸‹é¢ç®€å•è®²ä¸€ä¸‹å‡ ä¸ª


é…ç½®é¡¹åç§° | ä½œç”¨
---|---
contentBase | æœ¬åœ°æœåŠ¡å™¨æ‰€åŠ è½½çš„èµ„æºæ‰€åœ¨çš„ç›®å½•ï¼ˆæ³¨æ„æ˜¯ç›®å½•ï¼Œå³webpackä¼šå»å“ªä¸ªç›®å½•æ‰¾æ–‡ä»¶ï¼‰
port | ç«¯å£ï¼ˆé»˜è®¤æ˜¯8080ï¼‰
inline | æ˜¯å¦å®æ—¶åˆ·æ–°
host | ä¸»æœºï¼ˆé»˜è®¤localhostï¼‰
open | æ˜¯å¦è‡ªåŠ¨å¼€å¯æµè§ˆå™¨
... | ...

```JavaScript
devServer: {
    contentBase: "./dist",                 //æœ¬åœ°æœåŠ¡å™¨æ‰€åŠ è½½çš„é¡µé¢æ‰€åœ¨çš„ç›®å½•
    historyApiFallback: true,              //ä¸è·³è½¬
    inline: true                           //å®æ—¶åˆ·æ–°
    open:false,
} 
```
package.jsonä¸­çš„scriptsæ·»åŠ start

```json
"scripts": {
    "start": "node_modules/.bin/webpack",
    "server": "webpack-dev-server"
},
```

è¿è¡ŒæˆåŠŸ

æ­¤æ—¶ä¿®æ”¹å…¥å£æ–‡ä»¶index.jsçš„å†…å®¹ï¼Œå›åˆ°æµè§ˆå™¨å¯ä»¥å®æ—¶åˆ·æ–°ã€‚

#### loader

> **å®˜æ–¹è¯´æ³•ï¼š** loader ç”¨äºå¯¹æ¨¡å—çš„æºä»£ç è¿›è¡Œè½¬æ¢ã€‚loader å¯ä»¥ä½¿ä½ åœ¨ import æˆ–"åŠ è½½"æ¨¡å—æ—¶é¢„å¤„ç†æ–‡ä»¶ã€‚å› æ­¤ï¼Œloader ç±»ä¼¼äºå…¶ä»–æ„å»ºå·¥å…·ä¸­â€œä»»åŠ¡(task)â€ï¼Œå¹¶æä¾›äº†å¤„ç†å‰ç«¯æ„å»ºæ­¥éª¤çš„å¼ºå¤§æ–¹æ³•ã€‚loader å¯ä»¥å°†æ–‡ä»¶ä»ä¸åŒçš„è¯­è¨€ï¼ˆå¦‚ TypeScriptï¼‰è½¬æ¢ä¸º JavaScriptï¼Œæˆ–å°†å†…è”å›¾åƒè½¬æ¢ä¸º data URLã€‚loader ç”šè‡³å…è®¸ä½ ç›´æ¥åœ¨ JavaScript æ¨¡å—ä¸­ import CSSæ–‡ä»¶ï¼

##### æ¥ä¸‹æ¥å°†é…ç½®ä¸€ä¸ªvueå¼€å‘ç¯å¢ƒ

###### ä¸‹è½½ä¾èµ–

```bash
cnpm install 
webpack 
webpack-dev-server 
vue-loader 
vue-html-loader 
css-loader 
vue-style-loader 
vue-hot-reload-api 
babel-loader 
babel-core 
babel-plugin-transform-runtime 
babel-preset-es2015 
babel-runtime@5
vue-template-compiler
--save-dev
```

ä¸‹è½½å®Œä¹‹åè¿è¡Œnpm run serverï¼ŒæŠ¥é”™:è¯´æ¨¡å—ä»£ç è½¬åŒ–å¤±è´¥ï¼Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ªé€‚å½“çš„loaderæ¥å¤„ç†.vueçš„æ–‡ä»¶ã€‚
å“¦ï¼Œåº”è¯¥æ˜¯æˆ‘ä»¬æ²¡æœ‰é…ç½®ç›¸å…³çš„loader

```bash
ERROR in ./src/App.vue
Module parse failed: Unexpected token (1:0)
You may need an appropriate loader to handle this file type.
| <template>
|   <div id="app">
|     yuansichao
 @ ./src/index.js 3:0-28 10:16-19
 @ multi ./node_modules/_webpack-dev-server@3.1.4@webpack-dev-server/client?http://localhost:8080 ./src/index.js
 ```

ç®€å•é…ç½®vue-loaderä¹‹å
```JavaScript
module:{
    rules:[{
      test: /\.vue$/,
      loader: 'vue-loader',
    }]
  }
```

å†æ¬¡è¿è¡Œè¿˜æ˜¯å‡ºé”™

```bash
ERROR in ./src/App.vue?vue&type=template&id=7ba5bd90
Module parse failed: Unexpected token (2:0)
You may need an appropriate loader to handle this file type.
|
| <div id="app">
|   yuansichao
| </div>
 @ ./src/App.vue 1:0-81 11:2-8 12:2-17
 @ ./src/index.js
 @ multi ./node_modules/_webpack-dev-server@3.1.4@webpack-dev-server/client?http://localhost:8080 ./src/index.js

ERROR in ./src/App.vue
vue-loader was used without the corresponding plugin. Make sure to include VueLoaderPlugin in your webpack config.
 @ ./src/index.js 3:0-28 10:16-19
 @ multi ./node_modules/_webpack-dev-server@3.1.4@webpack-dev-server/client?http://localhost:8080 ./src/index.js
```

é”™è¯¯æ˜¯vue-loader was used without the corresponding plugin. Make sure to include VueLoaderPlugin in your webpack config.

æŸ¥çœ‹vue-loaderå®˜æ–¹æ–‡æ¡£

> Vue Loader çš„é…ç½®å’Œå…¶å®ƒçš„ loader ä¸å¤ªä¸€æ ·ã€‚é™¤äº†é€šè¿‡ä¸€æ¡è§„åˆ™å°† vue-loader åº”ç”¨åˆ°æ‰€æœ‰æ‰©å±•åä¸º .vue çš„æ–‡ä»¶ä¸Šä¹‹å¤–ï¼Œè¯·ç¡®ä¿åœ¨ä½ çš„ webpack é…ç½®ä¸­æ·»åŠ  Vue Loader çš„æ’ä»¶ï¼š

```bash
// webpack.config.js
const { VueLoaderPlugin } = require('vue-loader')

module.exports = {
  module: {
    rules: [
      // ... å…¶å®ƒè§„åˆ™
      {
        test: /\.vue$/,
        loader: 'vue-loader'
      }
    ]
  },
  plugins: [
    // è¯·ç¡®ä¿å¼•å…¥è¿™ä¸ªæ’ä»¶ï¼
    new VueLoaderPlugin()
  ]
}
```

**è¿™ä¸ªæ’ä»¶æ˜¯å¿…é¡»çš„**å®ƒçš„èŒè´£æ˜¯å°†ä½ å®šä¹‰è¿‡çš„å…¶å®ƒè§„åˆ™å¤åˆ¶å¹¶åº”ç”¨åˆ° .vue æ–‡ä»¶é‡Œç›¸åº”è¯­è¨€çš„å—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€æ¡åŒ¹é… /\.js$/ çš„è§„åˆ™ï¼Œé‚£ä¹ˆå®ƒä¼šåº”ç”¨åˆ° .vue æ–‡ä»¶é‡Œçš„< script >å—ã€‚

ä¸€ä¸ªæ›´å®Œæ•´çš„ webpack é…ç½®ç¤ºä¾‹çœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```JavaScript
// webpack.config.js
const path = require('path')
const { VueLoaderPlugin } = require('vue-loader')

module.exports = {
  mode: 'development',
  module: {
    rules: [
      {
        test: /\.vue$/,
        loader: 'vue-loader'
      },
      // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.js` æ–‡ä»¶
      // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<script>` å—
      {
        test: /\.js$/,
        loader: 'babel-loader'
      },
      // å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.css` æ–‡ä»¶
      // ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<style>` å—
      {
        test: /\.css$/,
        use: [
          'vue-style-loader',
          'css-loader'
        ]
      }
    ]
  },
  plugins: [
    // è¯·ç¡®ä¿å¼•å…¥è¿™ä¸ªæ’ä»¶æ¥æ–½å±•é­”æ³•
    new VueLoaderPlugin()
  ]
}
```

ä¿®æ”¹å®Œä¹‹åå¯ä»¥è¿è¡Œä½†æ˜¯æ— æ³•æ˜¾ç¤ºé¡µé¢ï¼Œé¡µé¢æŠ¥é”™

You are using the runtime-only build of Vue where the template compiler is not available. Either pre-compile the templates into render functions, or use the compiler-included build.

æ‰€ä»¥æ˜¯è¿˜éœ€è¦é…ç½®vue-template-compilerï¼Ÿä½†æ˜¯åœ¨ç½‘ä¸Šæ‰¾äº†ä¸€ç•ªï¼Œå‘ç°å¹¶ä¸éœ€è¦é…ç½®ï¼Œé‚£é—®é¢˜åœ¨å“ªï¼Ÿå‘ç°main.jsçš„å†™æ³•å†™çš„è²Œä¼¼å’Œå®˜æ–¹çš„ä¸ä¸€æ ·

æ”¹ä¹‹å‰
```JavaScript
new Vue({
  el: '#app',
  components: { App },
  template: '<App/>'
})
```
æ”¹ä¹‹å
```JavaScript
new Vue({
  el: '#app',
  render: h => h(App)
})
```

é‡æ–°è¿è¡Œï¼Œå®Œç¾è¿è¡Œï¼ä½†è¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„.vueé‡Œé¢è¿˜æ˜¯æ²¡æœ‰jså’Œcssï¼Œæˆ‘ä»¬å†æ¬¡è¯•ä¸€ä¸‹å†™äº†å­ç»„ä»¶

ä»£ç è‡ªåŠ¨æ›´æ–°

###### å¢åŠ CSS

åœ¨.vueä¸­çš„styleæ ‡ç­¾é‡Œé¢æ–°å¢cssä»£ç ï¼Œä»£ç æ›´æ–°ä¹‹åï¼ŒæŠ¥é”™ï¼ˆæ˜¾ç„¶ä¼šæŠ¥é”™å•ŠğŸ¤£ï¼‰

```bash
ERROR in ./src/App.vue?vue&type=style&index=0&id=7ba5bd90&scoped=true&lang=css (./node_modules/_vue-loader@15.1.0@vue-loader/lib??vue-loader-options!./src/App.vue?vue&type=style&index=0&id=7ba5bd90&scoped=true&lang=css)
Module parse failed: Unexpected character '#' (17:0)
You may need an appropriate loader to handle this file type.
```

åœ¨webpack.config.jsä¸­é…ç½®css-loader(è¿™åªæ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„loader,è¿˜æœ‰å…¶ä»–å¸¸è§çš„loader)

```JavaScript
// å®ƒä¼šåº”ç”¨åˆ°æ™®é€šçš„ `.css` æ–‡ä»¶
// ä»¥åŠ `.vue` æ–‡ä»¶ä¸­çš„ `<style>` å—
{
    test: /\.css$/,
    use: [
        'vue-style-loader',
        'css-loader'
    ]
}
```

ä¹‹åå°±å¯ä»¥åœ¨styleé‡Œé¢æ„‰å¿«çš„ä¹¦å†™cssäº†

###### å¢åŠ JavaScriptä»£ç 

åœ¨Appçš„mountedçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°é‡Œé¢æ‰“å°ä¸€æ®µä»£ç ï¼Œå¹¶å°è¯•ä½¿ç”¨ES6çš„è¯­æ³•ï¼ˆè²Œä¼¼ä½¿ç”¨ES5éƒ½æ˜¯æ²¡é—®é¢˜çš„ï¼‰ã€‚ä¹Ÿæ²¡é—®é¢˜ï¼›(ç›®å‰æ˜¯æ²¡å‘ç°ç”Ÿå‘½é—®é¢˜ï¼Œå¯èƒ½æ˜¯v8å¼•æ“æ”¯æŒçš„ES6è¯­æ³•æ¯”è¾ƒå¤šå§)

###### ç®€å•çš„åˆ°è¿™ï¼Œå‘ç°å·²ç»å¯ä»¥åŸºæœ¬çš„ä½¿ç”¨vueäº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ã€‚å®˜æ–¹çš„index.htmlæ–‡ä»¶æ˜¯é»˜è®¤åœ¨æ ¹ç›®å½•çš„ã€‚å¹¶ä¸”åŒ…æ‹¬å¼•å…¥jsæ–‡ä»¶ã€‚è€Œæˆ‘ä»¬çš„æ˜¯åœ¨distæ–‡ä»¶é‡Œé¢ã€‚å¹¶ä¸”éœ€è¦æ‰‹åŠ¨å¼•å…¥jsæ–‡ä»¶ã€‚å› ä¸ºæˆ‘ä»¬çš„devServeré…ç½®ï¼š

```JavaScript
devServer: {
    contentBase: "./dist",                 //æœ¬åœ°æœåŠ¡å™¨æ‰€åŠ è½½çš„é¡µé¢æ‰€åœ¨çš„ç›®å½•
    historyApiFallback: true,              //ä¸è·³è½¬
    inline: true,                          //å®æ—¶åˆ·æ–°
    open:false,
},
```

é‚£å¦‚ä½•åšåˆ°é‚£æ ·å‘¢ï¼Ÿæœ¬åœ°è¿è¡Œçš„æ—¶å€™æ ¹ç›®å½•æ˜¯ä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œæ‰“åŒ…åˆ°distç›®å½•çš„æ—¶å€™ï¼Œè¿åŒindex.htmlä¸€èµ·æ‰“åŒ…åˆ°distç›®å½•ï¼Ÿ

æŸ¥çœ‹å®˜æ–¹vue-cliç”Ÿæˆçš„é¡¹ç›®ï¼Œåœ¨webpack.dev.config.jsé…ç½®äº†ä¸€ä¸ªHtmlWebpackPluginã€‚ç”±æ­¤çŒœæµ‹æ˜¯å› ä¸ºè¿™ä¸ªå¼•èµ·çš„ã€‚æ‰€ä»¥æˆ‘å°è¯•äº†ä¸€ä¸‹ã€‚

åœ¨webpack.config.jsä¸­pluginsä¸­åŠ å…¥ï¼Œéœ€è¦å…ˆå¼•å…¥HtmlWebpackPluginæ’ä»¶

```JavaScript
new HtmlWebpackPlugin({
    filename: 'index.html',
    template: 'index.html',
    inject: true
})
```
ç„¶ååˆ é™¤distä¸‹é¢çš„index.htmlæ–‡ä»¶ã€‚å¹¶ç§»é™¤åˆ°æ ¹ç›®å½•ä¸‹ï¼Œåˆ é™¤index.htmlä¸‹å¼•å…¥jsçš„ä»£ç ã€‚devSeverå¹¶æ²¡æœ‰æ”¹å˜é…ç½®,é‡æ–°è¿è¡Œï¼ŒæˆåŠŸï¼Œè¿™ä¹Ÿè¡Œï¼Ÿï¼Ÿï¼Ÿæ–‡æ¡£è¯´ï¼Œä¼šåœ¨distï¼ˆä¹Ÿå°±æ˜¯outputçš„pathï¼‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªindex.htmlï¼Œ(ä½†å®é™…ä¸Šæ˜¯æ²¡æœ‰ç”Ÿæˆçš„)

```JavaScript
devServer: {
    contentBase: "./dist",                 //æœ¬åœ°æœåŠ¡å™¨æ‰€åŠ è½½çš„é¡µé¢æ‰€åœ¨çš„ç›®å½•
    historyApiFallback: true,              //ä¸è·³è½¬
    inline: true,                          //å®æ—¶åˆ·æ–°
    open:false,
  },
```


